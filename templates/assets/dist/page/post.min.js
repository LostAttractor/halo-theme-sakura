import{d as m,s as i,_ as C,U as _,I as h}from"../main.min.js";import"../assets/_commonjsHelpers-042e6b4d.js";var b=Object.defineProperty,w=Object.getOwnPropertyDescriptor,p=(g,o,s,n)=>{for(var t=n>1?void 0:n?w(o,s):o,r=g.length-1,e;r>=0;r--)(e=g[r])&&(t=(n?e(o,s,t):e(t))||t);return n&&t&&b(o,s,t),t};class u{registerOriginalPostCopy(){var s;const o=document.querySelector(".entry-content");o&&(i.getPageConfig("isOriginal")=="false"||!((s=i.getThemeConfig("post","post_original_copy",Boolean))!=null&&s.valueOf())||o.addEventListener("copy",n=>{n.preventDefault();const t=window.getSelection();if(!t)return;const r=t.toString();if(!r||r.length<30)return;const e=document.querySelector(".post-article");if(!e)return;const c=e.getAttribute("data-owner"),l=e.getAttribute("data-url"),a=e.getAttribute("data-siteName");let d=`
      ${i.translate("post.copyright_template_html.info","# 商业转载请联系作者获得授权，非商业转载请注明出处。<br>")}
      ${i.translate("post.copyright_template_html.license","# 协议(License): 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)<br>")}
      ${i.translate("post.copyright_template_html.author",`# 作者(Author): ${c} <br>`,{postAuthor:c})}
      ${i.translate("post.copyright_template_html.url",`# 链接(URL): ${l} <br>`,{postUrl:l})}
      ${i.translate("post.copyright_template_html.url",`# 来源(Source): ${a} <br>`,{siteName:a})}
      <br>
      `;const f=t.toString(),y=`${d}${f.replace(/\r\n/g,"<br>")}`,T=`${d.replace(/<br>/g,`
`)}${f.replace(/\r\n/g,`
`)}`;n.clipboardData&&(n.clipboardData.setData("text/html",y),n.clipboardData.setData("text/plain",T))}))}async registerShareWechat(){const o=document.getElementById("qrcode");if(!o)return;(await C(()=>import("../assets/browser-21db0a97.js").then(n=>n.b),[])).toCanvas(o,o.getAttribute("data-url"),{width:120,color:{dark:"#000000",light:"#ffffff"}})}registerWordCountToast(){var n,t;if(!((n=i.getThemeConfig("post","post_word_count_toast",Boolean))!=null&&n.valueOf()))return;const o=document.querySelector(".entry-content");if(!o)return;const s=_.getWordCount(o);if(s>0){const r=_.caclEstimateReadTime(s);let e="NORMAL";r<=60*10?e="NORMAL":r>60*10&&r<=60*30?e="MEDIUM":e="DIFFICULTY";let c="";const l=h.secondToTimeString(r);if(window.innerWidth>860){const a={normal:"文章篇幅适中，可以放心阅读。",medium:"文章比较长，建议分段阅读。",difficulty:"文章内容已经很陈旧了，也许不再适用！"};c=((t=i.getThemeConfig("post",`post_word_count_toast_${e.toLowerCase()}`,String))==null?void 0:t.valueOf())||i.translate("post.word_count_toast.remind",a[e.toLowerCase()],{context:e.toLowerCase()})}this.createPostToast(o,i.translate("post.word_count_toast.content",`文章共 <b>${s}</b> 字，阅读完预计需要 <b>${l}</b>。${c}`,{postWordCount:s,timeString:l,remind:c}),e,"word_count")}}registerEditTimeToast(){var l,a;const o=document.querySelector(".entry-content");if(!o||!((l=i.getThemeConfig("post","post_edit_time_toast",Boolean))!=null&&l.valueOf())||!i.getPageConfig("postLastModifyTime"))return;const s=i.getPageConfig("postLastModifyTime"),n=new Date(s),t=new Date().getTime()-n.getTime();let r="NORMAL";t<=1e3*60*60*24*30?r="NORMAL":t>1e3*60*60*24*30&&t<=1e3*60*60*24*90?r="MEDIUM":r="DIFFICULTY";let e="";if(window.innerWidth>860){const d={normal:"近期有所更新，请放心阅读！",medium:"文章内容已经有一段时间没有更新了，也许不再适用！",difficulty:"文章内容已经很陈旧了，也许不再适用！"};e=((a=i.getThemeConfig("post",`post_edit_time_toast_${r.toLowerCase()}`,String))==null?void 0:a.valueOf())||i.translate("post.edit_time_toast.remind",d[r.toLowerCase()],{context:r.toLowerCase()})}const c=h.RelativeTimeFormat(n.getTime());this.createPostToast(o,i.translate("post.edit_time_toast.content",`文章内容上次编辑时间于 <b>${c}</b>。${e}`,{sinceLastTime:c,remind:e}),r,"last_time")}createPostToast(o,s,n,t){const e=`<div class="${t} minicode" style="background-color: ${{NORMAL:"rgba(167, 210, 226, 1)",MEDIUM:"rgba(255, 197, 160, 1)",DIFFICULTY:"rgba(239, 206, 201, 1)"}[n]}">
      <span class="content-toast">
        ${s}
      </span>
      <div class="hide-minicode">
        <span class="iconify iconify--small" data-icon="fa:times"></span>
      </div>
    </div>`;if(o.querySelector(`.${t}`))return;const a=new DOMParser().parseFromString(e,"text/html").querySelector(`.${t}`);a.querySelector(".hide-minicode").addEventListener("click",()=>{a.classList.add("hide")},{once:!0}),o.insertAdjacentElement("afterbegin",a)}}p([m()],u.prototype,"registerOriginalPostCopy",1);p([m()],u.prototype,"registerShareWechat",1);p([m()],u.prototype,"registerWordCountToast",1);p([m()],u.prototype,"registerEditTimeToast",1);
