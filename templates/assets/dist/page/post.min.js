import{d,s as i,_ as T,U as f,I as _}from"../main.min.js";import"../assets/_commonjsHelpers-042e6b4d.js";var C=Object.defineProperty,b=Object.getOwnPropertyDescriptor,m=(g,o,r,n)=>{for(var e=n>1?void 0:n?b(o,r):o,t=g.length-1,s;t>=0;t--)(s=g[t])&&(e=(n?s(o,r,e):s(e))||e);return n&&e&&C(o,r,e),e};class p{registerOriginalPostCopy(){const o=document.querySelector(".entry-content");o&&(i.getPageConfig("isOriginal")=="false"||!i.getThemeConfig("post","post_original_copy",Boolean)||o.addEventListener("copy",r=>{r.preventDefault();const n=window.getSelection();if(!n)return;const e=n.toString();if(!e||e.length<30)return;const t=document.querySelector(".post-article");if(!t)return;const s=t.getAttribute("data-owner"),a=t.getAttribute("data-url"),c=t.getAttribute("data-siteName");let l=`
      ${i.translate("post.copyright_template_html.info","# 商业转载请联系作者获得授权，非商业转载请注明出处。<br>")}
      ${i.translate("post.copyright_template_html.license","# 协议(License): 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)<br>")}
      ${i.translate("post.copyright_template_html.author",`# 作者(Author): ${s} <br>`,{postAuthor:s})}
      ${i.translate("post.copyright_template_html.url",`# 链接(URL): ${a} <br>`,{postUrl:a})}
      ${i.translate("post.copyright_template_html.url",`# 来源(Source): ${c} <br>`,{siteName:c})}
      <br>
      `;const u=n.toString(),h=`${l}${u.replace(/\r\n/g,"<br>")}`,y=`${l.replace(/<br>/g,`
`)}${u.replace(/\r\n/g,`
`)}`;r.clipboardData&&(r.clipboardData.setData("text/html",h),r.clipboardData.setData("text/plain",y))}))}async registerShareWechat(){const o=document.getElementById("qrcode");if(!o)return;(await T(()=>import("../assets/browser-21db0a97.js").then(n=>n.b),[])).toCanvas(o,o.getAttribute("data-url"),{width:120,color:{dark:"#000000",light:"#ffffff"}})}registerWordCountToast(){var n;if(!i.getThemeConfig("post","post_word_count_toast",Boolean))return;const o=document.querySelector(".entry-content");if(!o)return;const r=f.getWordCount(o);if(r>0){const e=f.caclEstimateReadTime(r);let t="NORMAL";e<=60*10?t="NORMAL":e>60*10&&e<=60*30?t="MEDIUM":t="DIFFICULTY";let s="";const a=_.secondToTimeString(e);if(window.innerWidth>860){const c={normal:"文章篇幅适中，可以放心阅读。",medium:"文章比较长，建议分段阅读。",difficulty:"文章内容已经很陈旧了，也许不再适用！"};s=((n=i.getThemeConfig("post",`post_word_count_toast_${t.toLowerCase()}`,String))==null?void 0:n.valueOf())||i.translate("post.word_count_toast.remind",c[t.toLowerCase()],{context:t.toLowerCase()})}this.createPostToast(o,i.translate("post.word_count_toast.content",`文章共 <b>${r}</b> 字，阅读完预计需要 <b>${a}</b>。${s}`,{postWordCount:r,timeString:a,remind:s}),t,"word_count")}}registerEditTimeToast(){var c;const o=document.querySelector(".entry-content");if(!o||!i.getThemeConfig("post","post_edit_time_toast",Boolean)||!i.getPageConfig("postLastModifyTime"))return;const r=i.getPageConfig("postLastModifyTime"),n=new Date(r),e=new Date().getTime()-n.getTime();let t="NORMAL";e<=1e3*60*60*24*30?t="NORMAL":e>1e3*60*60*24*30&&e<=1e3*60*60*24*90?t="MEDIUM":t="DIFFICULTY";let s="";if(window.innerWidth>860){const l={normal:"近期有所更新，请放心阅读！",medium:"文章内容已经有一段时间没有更新了，也许不再适用！",difficulty:"文章内容已经很陈旧了，也许不再适用！"};s=((c=i.getThemeConfig("post",`post_edit_time_toast_${t.toLowerCase()}`,String))==null?void 0:c.valueOf())||i.translate("post.edit_time_toast.remind",l[t.toLowerCase()],{context:t.toLowerCase()})}const a=_.RelativeTimeFormat(n.getTime());this.createPostToast(o,i.translate("post.edit_time_toast.content",`文章内容上次编辑时间于 <b>${a}</b>。${s}`,{sinceLastTime:a,remind:s}),t,"last_time")}createPostToast(o,r,n,e){const s=`<div class="${e} minicode" style="background-color: ${{NORMAL:"rgba(167, 210, 226, 1)",MEDIUM:"rgba(255, 197, 160, 1)",DIFFICULTY:"rgba(239, 206, 201, 1)"}[n]}">
      <span class="content-toast">
        ${r}
      </span>
      <div class="hide-minicode">
        <span class="iconify iconify--small" data-icon="fa:times"></span>
      </div>
    </div>`;if(o.querySelector(`.${e}`))return;const l=new DOMParser().parseFromString(s,"text/html").querySelector(`.${e}`);l.querySelector(".hide-minicode").addEventListener("click",()=>{l.classList.add("hide")},{once:!0}),o.insertAdjacentElement("afterbegin",l)}}m([d()],p.prototype,"registerOriginalPostCopy",1);m([d()],p.prototype,"registerShareWechat",1);m([d()],p.prototype,"registerWordCountToast",1);m([d()],p.prototype,"registerEditTimeToast",1);
