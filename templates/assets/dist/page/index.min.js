var p=Object.defineProperty;var m=(s,e,t)=>e in s?p(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var y=(s,e,t)=>(m(s,typeof e!="symbol"?e+"":e,t),t);import{d as a,s as u,_ as v}from"../main.min.js";var g=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d=(s,e,t,n)=>{for(var o=n>1?void 0:n?h(e,t):e,l=s.length-1,r;l>=0;l--)(r=s[l])&&(o=(n?r(e,t,o):r(o))||o);return n&&o&&g(e,t,o),o};class c{constructor(){y(this,"videoPlayer")}registerIndex(){console.log("123")}registerBackgroundChangeEvent(){const e=document.querySelector(".bg-change-js");if(!e)return;const t=document.getElementById("bg-next"),n=document.getElementById("bg-prev"),o=(u.getThemeConfig("random_image").getValue("rimage_cover_back_num",Number)||0).valueOf();t==null||t.addEventListener("click",()=>{let r=Number(e.getAttribute("data-currIndex"));o===0?r=Math.ceil(Math.random()*99):r=(r+1)%o,l(r)}),n==null||n.addEventListener("click",()=>{let r=Number(e.getAttribute("data-currIndex"));o===0?r=Math.ceil(Math.random()*99):r=(r-1+o)%o,l(r)});const l=r=>{const i=e.getAttribute("data-url");e.src=`${i}&t=${r}`,e.setAttribute("data-currIndex",`${r}`)}}registerBackgroundVideo(){const e=document.querySelector(".video-container");if(!e)return;e.insertAdjacentElement("afterbegin",document.createElement("video"));const t=e.querySelector(".video-status"),n=document.querySelector(".focusinfo"),o=e.querySelector(".video-play"),l=e.querySelector(".video-pause");o==null||o.addEventListener("click",async()=>{t.innerHTML="正在载入视频 ...",t.style.bottom="0",this.videoPlayer?this.videoPlayer.play():v(()=>import("../assets/video.es-f4d77b6d.js"),[]).then(r=>{var i;this.videoPlayer=r.default(e.querySelector("video"),{controls:!1,controlsBar:!1,children:["MediaLoader"],autoplay:!1,preload:"auto",muted:!1,loop:!1,sources:[{src:(i=u.getThemeConfig("mainScreen").getValue("bgvideo_url",String))==null?void 0:i.toString()}]}),this.videoPlayer.on("loadeddata",()=>{t.style.bottom="-100px",n.style.top="-999px",o.style.display="none",l.style.display="block",this.videoPlayer.play()}),this.videoPlayer.on("play",()=>{t.style.bottom="-100px",n.style.top="-999px",o.style.display="none",l.style.display="block"}),this.videoPlayer.on("pause",()=>{t.innerHTML="已暂停 ...",t.style.bottom="0",n.style.top="0",o.style.display="block",l.style.display="none"}),this.videoPlayer.on("waiting",()=>{t.innerHTML="加载中 ...",t.style.bottom="0"}),this.videoPlayer.on("canplay",()=>{t.style.bottom="-100px"}),this.videoPlayer.on("error",()=>{n.style.top="0",t.style.bottom="-100px",o.style.display="block",l.style.display="none",this.videoPlayer.dispose(),e.insertAdjacentElement("afterbegin",document.createElement("video")),this.videoPlayer=void 0}),this.videoPlayer.on("ended",()=>{n.style.top="0",t.style.bottom="-100px",o.style.display="block",l.style.display="none",this.videoPlayer.dispose(),e.insertAdjacentElement("afterbegin",document.createElement("video")),this.videoPlayer=void 0})}).catch(r=>{console.error(r),t.innerHTML="视频加载失败",t.style.bottom="0",setTimeout(()=>{t.style.bottom="-100px"},2e3)})}),l==null||l.addEventListener("click",()=>{this.videoPlayer&&this.videoPlayer.pause()})}}d([a(!1)],c.prototype,"registerIndex",1);d([a(!1)],c.prototype,"registerBackgroundChangeEvent",1);d([a(!1)],c.prototype,"registerBackgroundVideo",1);
