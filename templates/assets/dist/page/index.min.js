var p=Object.defineProperty;var m=(l,t,e)=>t in l?p(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var y=(l,t,e)=>(m(l,typeof t!="symbol"?t+"":t,e),e);import{d as a,s as u,_ as v}from"../main.min.js";var g=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d=(l,t,e,s)=>{for(var o=s>1?void 0:s?h(t,e):t,n=l.length-1,r;n>=0;n--)(r=l[n])&&(o=(s?r(t,e,o):r(o))||o);return s&&o&&g(t,e,o),o};class c{constructor(){y(this,"videoPlayer")}registerIndex(){console.log("123")}registerBackgroundChangeEvent(){const t=document.querySelector(".bg-change-js");if(!t)return;const e=document.getElementById("bg-next"),s=document.getElementById("bg-prev"),o=(u.getThemeConfig("random_image").getValue("rimage_cover_back_num",Number)||0).valueOf();e==null||e.addEventListener("click",()=>{let r=Number(t.getAttribute("data-currIndex"));o===0?r=Math.ceil(Math.random()*99):r=(r+1)%o,n(r)}),s==null||s.addEventListener("click",()=>{let r=Number(t.getAttribute("data-currIndex"));o===0?r=Math.ceil(Math.random()*99):r=(r-1+o)%o,n(r)});const n=r=>{const i=t.getAttribute("data-url");t.src=`${i}&t=${r}`,t.setAttribute("data-currIndex",`${r}`)}}registerBackgroundVideo(){const t=document.querySelector(".video-container");if(!t)return;t.insertAdjacentElement("afterbegin",document.createElement("video"));const e=t.querySelector(".video-status"),s=document.querySelector(".focusinfo"),o=t.querySelector(".video-play"),n=t.querySelector(".video-pause");o==null||o.addEventListener("click",async()=>{e.innerHTML="正在载入视频 ...",e.style.bottom="0",this.videoPlayer?this.videoPlayer.play():v(()=>import("../assets/video.es-f4d77b6d.js"),[]).then(r=>{var i;this.videoPlayer=r.default(t.querySelector("video"),{controls:!1,controlsBar:!1,children:["MediaLoader"],autoplay:!1,preload:"auto",muted:!1,loop:!1,sources:[{src:(i=u.getThemeConfig("mainScreen").getValue("bgvideo_url",String))==null?void 0:i.toString()}]}),this.videoPlayer.on("loadeddata",()=>{e.style.bottom="-100px",s.style.top="-999px",o.style.display="none",n.style.display="block",this.videoPlayer.play()}),this.videoPlayer.on("play",()=>{e.style.bottom="-100px",s.style.top="-999px",o.style.display="none",n.style.display="block"}),this.videoPlayer.on("pause",()=>{e.innerHTML="已暂停 ...",e.style.bottom="0",s.style.top="0",o.style.display="block",n.style.display="none"}),this.videoPlayer.on("waiting",()=>{e.innerHTML="加载中 ...",e.style.bottom="0"}),this.videoPlayer.on("canplay",()=>{e.style.bottom="-100px"}),this.videoPlayer.on("error",()=>{e.innerHTML="视频播放错误",setTimeout(()=>{s.style.top="0",e.style.bottom="-100px",o.style.display="block",n.style.display="none",this.videoPlayer.dispose(),t.insertAdjacentElement("afterbegin",document.createElement("video")),this.videoPlayer=void 0},2e3)}),this.videoPlayer.on("ended",()=>{s.style.top="0",e.style.bottom="-100px",o.style.display="block",n.style.display="none",this.videoPlayer.dispose(),t.insertAdjacentElement("afterbegin",document.createElement("video")),this.videoPlayer=void 0})}).catch(r=>{console.error(r),e.innerHTML="视频加载失败",e.style.bottom="0",setTimeout(()=>{e.style.bottom="-100px"},2e3)})}),n==null||n.addEventListener("click",()=>{this.videoPlayer&&this.videoPlayer.pause()})}}d([a(!1)],c.prototype,"registerIndex",1);d([a(!1)],c.prototype,"registerBackgroundChangeEvent",1);d([a(!1)],c.prototype,"registerBackgroundVideo",1);
